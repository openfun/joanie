UtilsCourseProductRelationTestCase.test_utils_offering_synchronize_offerings:
- db: 'SELECT COUNT(*) FROM (SELECT DISTINCT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" IN (SELECT DISTINCT U0."course_product_relation_id" FROM "joanie_offeringrule" U0 WHERE (U0."is_active" AND (((U0."start" AT TIME ZONE ''UTC'')::date = #::date AND EXTRACT(HOUR FROM U0."start" AT TIME ZONE ''UTC'') = #) OR ((U0."end" AT TIME ZONE ''UTC'')::date = #::date AND EXTRACT(HOUR FROM U0."end" AT TIME ZONE ''UTC'') = #))))) subquery'
- db: 'SELECT DISTINCT ... FROM "joanie_course_product_relation" INNER JOIN "joanie_course" ON ("joanie_course_product_relation"."course_id" = "joanie_course"."id") INNER JOIN "joanie_product" ON ("joanie_course_product_relation"."product_id" = "joanie_product"."id") WHERE "joanie_course_product_relation"."id" IN (SELECT DISTINCT U0."course_product_relation_id" FROM "joanie_offeringrule" U0 WHERE (U0."is_active" AND (((U0."start" AT TIME ZONE ''UTC'')::date = #::date AND EXTRACT(HOUR FROM U0."start" AT TIME ZONE ''UTC'') = #) OR ((U0."end" AT TIME ZONE ''UTC'')::date = #::date AND EXTRACT(HOUR FROM U0."end" AT TIME ZONE ''UTC'') = #)))) ORDER BY "joanie_course_product_relation"."created_on" DESC'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE ("joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid) LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") WHERE "joanie_offeringrule"."course_product_relation_id" = #::uuid ORDER BY "joanie_course_product_relation"."created_on" DESC, "joanie_offeringrule"."position" ASC'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT # AS "a" FROM "joanie_product_target_course_relation" WHERE ("joanie_product_target_course_relation"."product_id" = #::uuid AND "joanie_product_target_course_relation"."is_graded") LIMIT #'
- db: 'SELECT ... FROM "joanie_product" INNER JOIN "joanie_product_target_course_relation" ON ("joanie_product"."id" = "joanie_product_target_course_relation"."product_id") LEFT OUTER JOIN "joanie_product_target_course_relation_course_runs" ON ("joanie_product_target_course_relation"."id" = "joanie_product_target_course_relation_course_runs"."producttargetcourserelation_id") WHERE (("joanie_product_target_course_relation_course_runs"."courserun_id" IS # OR "joanie_product_target_course_relation_course_runs"."courserun_id" = #::uuid) AND "joanie_product_target_course_relation"."course_id" = #::uuid) ORDER BY "joanie_product"."created_on" DESC'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE ("joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid) LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") WHERE "joanie_offeringrule"."course_product_relation_id" = #::uuid ORDER BY "joanie_course_product_relation"."created_on" DESC, "joanie_offeringrule"."position" ASC'
- db: 'SELECT # AS "a" FROM "joanie_product_target_course_relation" WHERE ("joanie_product_target_course_relation"."product_id" = #::uuid AND "joanie_product_target_course_relation"."is_graded") LIMIT #'
- db: 'SELECT ... FROM "joanie_product" INNER JOIN "joanie_product_target_course_relation" ON ("joanie_product"."id" = "joanie_product_target_course_relation"."product_id") LEFT OUTER JOIN "joanie_product_target_course_relation_course_runs" ON ("joanie_product_target_course_relation"."id" = "joanie_product_target_course_relation_course_runs"."producttargetcourserelation_id") WHERE (("joanie_product_target_course_relation_course_runs"."courserun_id" IS # OR "joanie_product_target_course_relation_course_runs"."courserun_id" = #::uuid) AND "joanie_product_target_course_relation"."course_id" = #::uuid) ORDER BY "joanie_product"."created_on" DESC'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE ("joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid) LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") WHERE "joanie_offeringrule"."course_product_relation_id" = #::uuid ORDER BY "joanie_course_product_relation"."created_on" DESC, "joanie_offeringrule"."position" ASC'
- db: 'SELECT # AS "a" FROM "joanie_product_target_course_relation" WHERE ("joanie_product_target_course_relation"."product_id" = #::uuid AND "joanie_product_target_course_relation"."is_graded") LIMIT #'
- db: 'SELECT ... FROM "joanie_product" INNER JOIN "joanie_product_target_course_relation" ON ("joanie_product"."id" = "joanie_product_target_course_relation"."product_id") LEFT OUTER JOIN "joanie_product_target_course_relation_course_runs" ON ("joanie_product_target_course_relation"."id" = "joanie_product_target_course_relation_course_runs"."producttargetcourserelation_id") WHERE (("joanie_product_target_course_relation_course_runs"."courserun_id" IS # OR "joanie_product_target_course_relation_course_runs"."courserun_id" = #::uuid) AND "joanie_product_target_course_relation"."course_id" = #::uuid) ORDER BY "joanie_product"."created_on" DESC'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE ("joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid) LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") WHERE "joanie_offeringrule"."course_product_relation_id" = #::uuid ORDER BY "joanie_course_product_relation"."created_on" DESC, "joanie_offeringrule"."position" ASC'
- db: 'SELECT # AS "a" FROM "joanie_product_target_course_relation" WHERE ("joanie_product_target_course_relation"."product_id" = #::uuid AND "joanie_product_target_course_relation"."is_graded") LIMIT #'
- db: 'SELECT ... FROM "joanie_product" INNER JOIN "joanie_product_target_course_relation" ON ("joanie_product"."id" = "joanie_product_target_course_relation"."product_id") LEFT OUTER JOIN "joanie_product_target_course_relation_course_runs" ON ("joanie_product_target_course_relation"."id" = "joanie_product_target_course_relation_course_runs"."producttargetcourserelation_id") WHERE (("joanie_product_target_course_relation_course_runs"."courserun_id" IS # OR "joanie_product_target_course_relation_course_runs"."courserun_id" = #::uuid) AND "joanie_product_target_course_relation"."course_id" = #::uuid) ORDER BY "joanie_product"."created_on" DESC'
