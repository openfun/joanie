OrganizationAgreementApiTest.test_api_organizations_agreement_list_by_signature_state:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."batch_order_id" = "joanie_batch_order"."id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_organization_access" ON ("joanie_organization"."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT ("joanie_batch_order"."state" IN (...) AND "joanie_batch_order"."state" IS NOT NULL) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_contract"."organization_signed_on" IS # AND "joanie_contract"."student_signed_on" IS #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."batch_order_id" = "joanie_batch_order"."id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_organization_access" ON ("joanie_organization"."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T7 ON ("joanie_contract"."organization_signatory_id" = T7."id") WHERE (NOT ("joanie_batch_order"."state" IN (...) AND "joanie_batch_order"."state" IS NOT NULL) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_contract"."organization_signed_on" IS # AND "joanie_contract"."student_signed_on" IS #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."id" IN (#::uuid) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (#::uuid)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "easy_thumbnails_source" WHERE ("easy_thumbnails_source"."name" = # AND "easy_thumbnails_source"."storage_hash" = #) LIMIT #'
- db: 'UPDATE "easy_thumbnails_source" SET ... WHERE "easy_thumbnails_source"."id" = #'
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreement_list_by_signature_state.2:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_contract"."organization_signed_on" IS # AND "joanie_contract"."student_signed_on" IS #)'
OrganizationAgreementApiTest.test_api_organizations_agreement_list_by_signature_state.3:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_contract"."organization_signed_on" IS # AND "joanie_contract"."student_signed_on" IS NOT NULL)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_contract"."organization_signed_on" IS # AND "joanie_contract"."student_signed_on" IS NOT NULL) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (#::uuid) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (#::uuid)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreement_list_by_signature_state.4:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_contract"."organization_signed_on" IS NOT NULL AND "joanie_contract"."student_signed_on" IS NOT NULL)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_contract"."organization_signed_on" IS NOT NULL AND "joanie_contract"."student_signed_on" IS NOT NULL) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (#::uuid) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (#::uuid)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "easy_thumbnails_source" WHERE ("easy_thumbnails_source"."name" = # AND "easy_thumbnails_source"."storage_hash" = #) LIMIT #'
- db: 'UPDATE "easy_thumbnails_source" SET ... WHERE "easy_thumbnails_source"."id" = #'
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreement_retrieve_with_accesses:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (#::uuid) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (#::uuid)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "easy_thumbnails_source" WHERE ("easy_thumbnails_source"."name" = # AND "easy_thumbnails_source"."storage_hash" = #) LIMIT #'
- db: 'UPDATE "easy_thumbnails_source" SET ... WHERE "easy_thumbnails_source"."id" = #'
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_by_offering:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT ... FROM "joanie_course_product_relation" INNER JOIN "joanie_course_product_relation_organizations" ON ("joanie_course_product_relation"."id" = "joanie_course_product_relation_organizations"."courseproductrelation_id") WHERE ("joanie_course_product_relation"."id" = #::uuid AND "joanie_course_product_relation_organizations"."organization_id" IN (#::uuid)) LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."batch_order_id" = "joanie_batch_order"."id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_organization_access" ON ("joanie_organization"."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_course_product_relation" ON ("joanie_batch_order"."relation_id" = "joanie_course_product_relation"."id") WHERE (NOT ("joanie_batch_order"."state" IN (...) AND "joanie_batch_order"."state" IS NOT NULL) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_batch_order"."organization_id" IN (SELECT U0."id" FROM "joanie_organization" U0 INNER JOIN "joanie_course_product_relation_organizations" U1 ON (U0."id" = U1."organization_id") WHERE U1."courseproductrelation_id" = #::uuid) AND "joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."batch_order_id" = "joanie_batch_order"."id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_organization_access" ON ("joanie_organization"."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_course_product_relation" ON ("joanie_batch_order"."relation_id" = "joanie_course_product_relation"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T10 ON ("joanie_contract"."organization_signatory_id" = T10."id") WHERE (NOT ("joanie_batch_order"."state" IN (...) AND "joanie_batch_order"."state" IS NOT NULL) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND "joanie_batch_order"."organization_id" IN (SELECT U0."id" FROM "joanie_organization" U0 INNER JOIN "joanie_course_product_relation_organizations" U1 ON (U0."id" = U1."organization_id") WHERE U1."courseproductrelation_id" = #::uuid) AND "joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."id" IN (#::uuid) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (#::uuid)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "easy_thumbnails_source" WHERE ("easy_thumbnails_source"."name" = # AND "easy_thumbnails_source"."storage_hash" = #) LIMIT #'
- db: 'UPDATE "easy_thumbnails_source" SET ... WHERE "easy_thumbnails_source"."id" = #'
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_by_offering.2:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT ... FROM "joanie_course_product_relation" INNER JOIN "joanie_course_product_relation_organizations" ON ("joanie_course_product_relation"."id" = "joanie_course_product_relation_organizations"."courseproductrelation_id") WHERE ("joanie_course_product_relation"."id" = #::uuid AND "joanie_course_product_relation_organizations"."organization_id" IN (#::uuid)) LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_batch_order" T8 ON ("joanie_contract"."id" = T8."contract_id") INNER JOIN "joanie_course_product_relation" ON (T8."relation_id" = "joanie_course_product_relation"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND T8."organization_id" IN (SELECT U0."id" FROM "joanie_organization" U0 INNER JOIN "joanie_course_product_relation_organizations" U1 ON (U0."id" = U1."organization_id") WHERE U1."courseproductrelation_id" = #::uuid) AND "joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_batch_order" T8 ON ("joanie_contract"."id" = T8."contract_id") INNER JOIN "joanie_course_product_relation" ON (T8."relation_id" = "joanie_course_product_relation"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T14 ON ("joanie_contract"."organization_signatory_id" = T14."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND T8."organization_id" IN (SELECT U0."id" FROM "joanie_organization" U0 INNER JOIN "joanie_course_product_relation_organizations" U1 ON (U0."id" = U1."organization_id") WHERE U1."courseproductrelation_id" = #::uuid) AND "joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (...) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (...)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "easy_thumbnails_source" WHERE ("easy_thumbnails_source"."name" = # AND "easy_thumbnails_source"."storage_hash" = #) LIMIT #'
- db: 'UPDATE "easy_thumbnails_source" SET ... WHERE "easy_thumbnails_source"."id" = #'
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_by_offering.3:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT ... FROM "joanie_course_product_relation" INNER JOIN "joanie_course_product_relation_organizations" ON ("joanie_course_product_relation"."id" = "joanie_course_product_relation_organizations"."courseproductrelation_id") WHERE ("joanie_course_product_relation"."id" = #::uuid AND "joanie_course_product_relation_organizations"."organization_id" IN (#::uuid)) LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_filter:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (...) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (...)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "easy_thumbnails_source" WHERE ("easy_thumbnails_source"."name" = # AND "easy_thumbnails_source"."storage_hash" = #) LIMIT #'
- db: 'UPDATE "easy_thumbnails_source" SET ... WHERE "easy_thumbnails_source"."id" = #'
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_filter.2:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (...) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (...) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (...)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (...) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "easy_thumbnails_source" WHERE ("easy_thumbnails_source"."name" = # AND "easy_thumbnails_source"."storage_hash" = #) LIMIT #'
- db: 'UPDATE "easy_thumbnails_source" SET ... WHERE "easy_thumbnails_source"."id" = #'
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- db: 'SELECT ... FROM "easy_thumbnails_thumbnail" WHERE ("easy_thumbnails_thumbnail"."name" = # AND "easy_thumbnails_thumbnail"."source_id" = # AND "easy_thumbnails_thumbnail"."storage_hash" = #) LIMIT #'
- db: SAVEPOINT `#`
- db: INSERT INTO "easy_thumbnails_thumbnail" (...) VALUES (...) RETURNING "easy_thumbnails_thumbnail"."id"
- db: RELEASE SAVEPOINT `#`
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_filter.3:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT ... FROM "joanie_course_product_relation" INNER JOIN "joanie_course_product_relation_organizations" ON ("joanie_course_product_relation"."id" = "joanie_course_product_relation_organizations"."courseproductrelation_id") WHERE ("joanie_course_product_relation"."id" = #::uuid AND "joanie_course_product_relation_organizations"."organization_id" IN (#::uuid)) LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_batch_order" T8 ON ("joanie_contract"."id" = T8."contract_id") INNER JOIN "joanie_course_product_relation" ON (T8."relation_id" = "joanie_course_product_relation"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND T8."organization_id" IN (SELECT U0."id" FROM "joanie_organization" U0 INNER JOIN "joanie_course_product_relation_organizations" U1 ON (U0."id" = U1."organization_id") WHERE U1."courseproductrelation_id" = #::uuid) AND "joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_batch_order" T8 ON ("joanie_contract"."id" = T8."contract_id") INNER JOIN "joanie_course_product_relation" ON (T8."relation_id" = "joanie_course_product_relation"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T14 ON ("joanie_contract"."organization_signatory_id" = T14."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = # AND T8."organization_id" IN (SELECT U0."id" FROM "joanie_organization" U0 INNER JOIN "joanie_course_product_relation_organizations" U1 ON (U0."id" = U1."organization_id") WHERE U1."courseproductrelation_id" = #::uuid) AND "joanie_course_product_relation"."course_id" = #::uuid AND "joanie_course_product_relation"."product_id" = #::uuid) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (...) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (...)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_filter_by_with_batch_order:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (...) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (...)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_filter_by_with_batch_order.2:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (...) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (...)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_list_with_accesses:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."batch_order_id" = "joanie_batch_order"."id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_organization_access" ON ("joanie_organization"."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT ("joanie_batch_order"."state" IN (...) AND "joanie_batch_order"."state" IS NOT NULL) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."batch_order_id" = "joanie_batch_order"."id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_organization_access" ON ("joanie_organization"."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T7 ON ("joanie_contract"."organization_signatory_id" = T7."id") WHERE (NOT ("joanie_batch_order"."state" IN (...) AND "joanie_batch_order"."state" IS NOT NULL) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."id" IN (...) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (...) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (...)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (...) ORDER BY "joanie_product"."created_on" DESC
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_retrieve_combine_filter_signature_state_and_contract_id:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND "joanie_batch_order"."organization_id" = #::uuid AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (#::uuid) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (#::uuid)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
OrganizationAgreementApiTest.test_api_organizations_agreements_retrieve_with_accesses:
- db: SELECT DISTINCT "joanie_contract"."id" FROM "joanie_contract" ORDER BY "joanie_contract"."id" ASC
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND UPPER("joanie_organization"."code"::text) = UPPER(#) AND "joanie_user"."username" = #)'
- db: 'SELECT ... FROM "joanie_contract" INNER JOIN "joanie_batch_order" ON ("joanie_contract"."id" = "joanie_batch_order"."contract_id") INNER JOIN "joanie_organization" ON ("joanie_batch_order"."organization_id" = "joanie_organization"."id") INNER JOIN "joanie_batch_order" T4 ON ("joanie_contract"."id" = T4."contract_id") INNER JOIN "joanie_organization" T5 ON (T4."organization_id" = T5."id") INNER JOIN "joanie_organization_access" ON (T5."id" = "joanie_organization_access"."organization_id") INNER JOIN "joanie_user" ON ("joanie_organization_access"."user_id" = "joanie_user"."id") INNER JOIN "joanie_contract_definition" ON ("joanie_contract"."definition_id" = "joanie_contract_definition"."id") LEFT OUTER JOIN "joanie_user" T9 ON ("joanie_contract"."organization_signatory_id" = T9."id") WHERE (NOT (EXISTS(SELECT # AS "a" FROM "joanie_batch_order" U1 WHERE (U1."state" = # AND U1."contract_id" = ("joanie_contract"."id")) LIMIT #)) AND UPPER("joanie_organization"."code"::text) = UPPER(#) AND "joanie_user"."username" = #) ORDER BY "joanie_contract"."created_on" DESC LIMIT #'
- db: SELECT ... FROM "joanie_batch_order" WHERE "joanie_batch_order"."contract_id" IN (#::uuid) ORDER BY "joanie_batch_order"."created_on" ASC
- db: SELECT ... FROM "joanie_organization" WHERE "joanie_organization"."id" IN (#::uuid) ORDER BY "joanie_organization"."created_on" DESC
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" IN (#::uuid) ORDER BY "joanie_course"."code" ASC
- db: SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" IN (#::uuid)
- db: SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" IN (#::uuid) ORDER BY "joanie_product"."created_on" DESC
- cache|get: parler.core.CourseTranslation.#.en-us
- cache|get: parler.core.ProductTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."username" = # LIMIT #'
- db: 'SELECT "joanie_organization_access"."role" FROM "joanie_organization_access" WHERE ("joanie_organization_access"."organization_id" = #::uuid AND "joanie_organization_access"."user_id" = #::uuid) ORDER BY "joanie_organization_access"."created_on" DESC LIMIT #'
