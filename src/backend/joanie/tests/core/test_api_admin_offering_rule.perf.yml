OfferingRuleAdminApiTest.test_admin_api_offering_rule_create_authenticated:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_product_relation" WHERE "joanie_course_product_relation"."id" = #::uuid LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."course_product_relation_id" = #::uuid'
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: INSERT INTO "joanie_offeringrule" (...) VALUES (...)
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") LEFT OUTER JOIN "joanie_enrollment" ON ("joanie_order"."enrollment_id" = "joanie_enrollment"."id") LEFT OUTER JOIN "joanie_course_run" ON ("joanie_enrollment"."course_run_id" = "joanie_course_run"."id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND ("joanie_order"."course_id" = #::uuid OR "joanie_course_run"."course_id" = #::uuid) AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" IN (...))'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND "joanie_order"."course_id" = #::uuid AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" = #)'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
OfferingRuleAdminApiTest.test_admin_api_offering_rule_delete_anonymous: []
OfferingRuleAdminApiTest.test_admin_api_offering_rule_delete_authenticated:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: 'SELECT "joanie_offeringrule_translation"."language_code" FROM "joanie_offeringrule_translation" WHERE "joanie_offeringrule_translation"."master_id" = #::uuid ORDER BY "joanie_offeringrule_translation"."language_code" ASC'
- cache|delete_many: []
- db: DELETE FROM "joanie_offeringrule_translation" WHERE "joanie_offeringrule_translation"."master_id" IN (#::uuid)
- db: DELETE FROM "joanie_order_offering_rules" WHERE "joanie_order_offering_rules"."offeringrule_id" IN (#::uuid)
- db: DELETE FROM "joanie_batch_order_offering_rules" WHERE "joanie_batch_order_offering_rules"."offeringrule_id" IN (#::uuid)
- db: DELETE FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."id" IN (#::uuid)
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
OfferingRuleAdminApiTest.test_admin_api_offering_rule_delete_cannot_edit:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: 'SELECT "joanie_offeringrule_translation"."language_code" FROM "joanie_offeringrule_translation" WHERE "joanie_offeringrule_translation"."master_id" = #::uuid ORDER BY "joanie_offeringrule_translation"."language_code" ASC'
- cache|delete_many: []
- db: DELETE FROM "joanie_offeringrule_translation" WHERE "joanie_offeringrule_translation"."master_id" IN (#::uuid)
- db: DELETE FROM "joanie_order_offering_rules" WHERE "joanie_order_offering_rules"."offeringrule_id" IN (#::uuid)
- db: DELETE FROM "joanie_batch_order_offering_rules" WHERE "joanie_batch_order_offering_rules"."offeringrule_id" IN (#::uuid)
- db: DELETE FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."id" IN (#::uuid)
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
OfferingRuleAdminApiTest.test_admin_api_offering_rule_list_authenticated:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."course_product_relation_id" = #::uuid'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE "joanie_offeringrule"."course_product_relation_id" = #::uuid ORDER BY "joanie_course_product_relation"."created_on" DESC, "joanie_offeringrule"."position" ASC LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") LEFT OUTER JOIN "joanie_enrollment" ON ("joanie_order"."enrollment_id" = "joanie_enrollment"."id") LEFT OUTER JOIN "joanie_course_run" ON ("joanie_enrollment"."course_run_id" = "joanie_course_run"."id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND ("joanie_order"."course_id" = #::uuid OR "joanie_course_run"."course_id" = #::uuid) AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" IN (...))'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND "joanie_order"."course_id" = #::uuid AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" = #)'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."discount_id" = #::uuid'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_voucher" WHERE "joanie_voucher"."discount_id" = #::uuid'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") LEFT OUTER JOIN "joanie_enrollment" ON ("joanie_order"."enrollment_id" = "joanie_enrollment"."id") LEFT OUTER JOIN "joanie_course_run" ON ("joanie_enrollment"."course_run_id" = "joanie_course_run"."id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND ("joanie_order"."course_id" = #::uuid OR "joanie_course_run"."course_id" = #::uuid) AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" IN (...))'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND "joanie_order"."course_id" = #::uuid AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" = #)'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."discount_id" = #::uuid'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_voucher" WHERE "joanie_voucher"."discount_id" = #::uuid'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") LEFT OUTER JOIN "joanie_enrollment" ON ("joanie_order"."enrollment_id" = "joanie_enrollment"."id") LEFT OUTER JOIN "joanie_course_run" ON ("joanie_enrollment"."course_run_id" = "joanie_course_run"."id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND ("joanie_order"."course_id" = #::uuid OR "joanie_course_run"."course_id" = #::uuid) AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" IN (...))'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND "joanie_order"."course_id" = #::uuid AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" = #)'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."discount_id" = #::uuid'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_voucher" WHERE "joanie_voucher"."discount_id" = #::uuid'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
OfferingRuleAdminApiTest.test_admin_api_offering_rule_patch_authenticated:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: 'UPDATE "joanie_offeringrule" SET ... WHERE "joanie_offeringrule"."id" = #::uuid'
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
OfferingRuleAdminApiTest.test_admin_api_offering_rule_patch_authenticated_empty_nb_seats:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: 'UPDATE "joanie_offeringrule" SET ... WHERE "joanie_offeringrule"."id" = #::uuid'
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
OfferingRuleAdminApiTest.test_admin_api_offering_rule_patch_authenticated_passing_none_for_description:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: 'UPDATE "joanie_offeringrule" SET ... WHERE "joanie_offeringrule"."id" = #::uuid'
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'UPDATE "joanie_offeringrule_translation" SET ... WHERE "joanie_offeringrule_translation"."id" = #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
OfferingRuleAdminApiTest.test_admin_api_offering_rule_retrieve_authenticated:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") LEFT OUTER JOIN "joanie_enrollment" ON ("joanie_order"."enrollment_id" = "joanie_enrollment"."id") LEFT OUTER JOIN "joanie_course_run" ON ("joanie_enrollment"."course_run_id" = "joanie_course_run"."id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND ("joanie_order"."course_id" = #::uuid OR "joanie_course_run"."course_id" = #::uuid) AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" IN (...))'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND "joanie_order"."course_id" = #::uuid AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" = #)'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_offeringrule" WHERE "joanie_offeringrule"."discount_id" = #::uuid'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_voucher" WHERE "joanie_voucher"."discount_id" = #::uuid'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
OfferingRuleAdminApiTest.test_admin_api_offering_rule_update_authenticated:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: 'UPDATE "joanie_offeringrule" SET ... WHERE "joanie_offeringrule"."id" = #::uuid'
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") LEFT OUTER JOIN "joanie_enrollment" ON ("joanie_order"."enrollment_id" = "joanie_enrollment"."id") LEFT OUTER JOIN "joanie_course_run" ON ("joanie_enrollment"."course_run_id" = "joanie_course_run"."id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND ("joanie_order"."course_id" = #::uuid OR "joanie_course_run"."course_id" = #::uuid) AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" IN (...))'
- db: 'SELECT COUNT(*) AS "__count" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE ("joanie_order_offering_rules"."offeringrule_id" = #::uuid AND "joanie_order"."course_id" = #::uuid AND "joanie_order"."product_id" = #::uuid AND "joanie_order"."state" = #)'
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT ... FROM "joanie_offeringrule_translation" WHERE ("joanie_offeringrule_translation"."master_id" = #::uuid AND "joanie_offeringrule_translation"."language_code" = #) LIMIT #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
OfferingRuleAdminApiTest.test_admin_api_offering_rule_update_description_authenticated:
- db: 'SELECT ... FROM "django_session" WHERE ("django_session"."expire_date" > #::timestamptz AND "django_session"."session_key" = #) LIMIT #'
- db: 'SELECT ... FROM "joanie_user" WHERE "joanie_user"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_offeringrule" INNER JOIN "joanie_course_product_relation" ON ("joanie_offeringrule"."course_product_relation_id" = "joanie_course_product_relation"."id") LEFT OUTER JOIN "joanie_discount" ON ("joanie_offeringrule"."discount_id" = "joanie_discount"."id") WHERE ("joanie_offeringrule"."course_product_relation_id" = #::uuid AND "joanie_offeringrule"."id" = #::uuid) LIMIT #'
- cache|get: parler.core.OfferingRuleTranslation.#.en-us
- cache|delete: CourseProductRelation-#-#.#-en-us
- cache|delete: OfferingLightSerializer-#-#.#-en-us
- cache|delete: OfferingSerializer-#-#.#-en-us
- cache|delete: ProductRelationSerializer-#-#.#-en-us
- cache|delete: CourseProductRelation-#-#.#-fr-fr
- cache|delete: OfferingLightSerializer-#-#.#-fr-fr
- cache|delete: OfferingSerializer-#-#.#-fr-fr
- cache|delete: ProductRelationSerializer-#-#.#-fr-fr
- db: 'UPDATE "joanie_offeringrule" SET ... WHERE "joanie_offeringrule"."id" = #::uuid'
- db: 'SELECT ... FROM "joanie_product" WHERE "joanie_product"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course" WHERE "joanie_course"."id" = #::uuid LIMIT #'
- db: 'SELECT ... FROM "joanie_course_run" WHERE "joanie_course_run"."course_id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
- db: 'UPDATE "joanie_offeringrule_translation" SET ... WHERE "joanie_offeringrule_translation"."id" = #'
- cache|set: parler.core.OfferingRuleTranslation.#.en-us
- db: 'SELECT # AS "a" FROM "joanie_order" INNER JOIN "joanie_order_offering_rules" ON ("joanie_order"."id" = "joanie_order_offering_rules"."order_id") WHERE "joanie_order_offering_rules"."offeringrule_id" = #::uuid LIMIT #'
