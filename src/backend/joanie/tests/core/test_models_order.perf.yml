OrderModelsTestCase.test_models_order_get_target_enrollments:
- db: 'SELECT ... FROM "joanie_enrollment" WHERE ("joanie_enrollment"."course_run_id" IN (SELECT DISTINCT X0."id" FROM "joanie_course_run" X0 LEFT OUTER JOIN "joanie_order_target_course_relation_course_runs" X1 ON (X0."id" = X1."courserun_id") WHERE (X1."ordertargetcourserelation_id" IN (SELECT U0."id" FROM "joanie_order_target_course_relation" U0 INNER JOIN "joanie_order_target_course_relation_course_runs" U2 ON (U0."id" = U2."ordertargetcourserelation_id") WHERE (U0."order_id" = #::uuid AND U2."courserun_id" IS NOT NULL)) OR X0."course_id" IN (SELECT W0."id" FROM "joanie_course" W0 INNER JOIN "joanie_order_target_course_relation" W1 ON (W0."id" = W1."course_id") WHERE (W1."order_id" = #::uuid AND NOT (EXISTS(SELECT # AS "a" FROM "joanie_order_target_course_relation" V1 WHERE (V1."id" IN (SELECT U0."id" FROM "joanie_order_target_course_relation" U0 INNER JOIN "joanie_order_target_course_relation_course_runs" U2 ON (U0."id" = U2."ordertargetcourserelation_id") WHERE (U0."order_id" = #::uuid AND U2."courserun_id" IS NOT NULL)) AND V1."id" = (W1."id") AND W1."course_id" = (W0."id")) LIMIT #)))))) AND "joanie_enrollment"."user_id" = #::uuid) ORDER BY "joanie_enrollment"."created_on" DESC'
OrderModelsTestCase.test_models_order_get_target_enrollments_for_certificate_product:
- db: 'SELECT ... FROM "joanie_enrollment" WHERE "joanie_enrollment"."id" = #::uuid ORDER BY "joanie_enrollment"."created_on" DESC'
OrderModelsTestCase.test_models_order_target_course_runs_property:
- db: 'SELECT ... FROM "joanie_course_run" LEFT OUTER JOIN "joanie_product_target_course_relation_course_runs" ON ("joanie_course_run"."id" = "joanie_product_target_course_relation_course_runs"."courserun_id") WHERE ("joanie_product_target_course_relation_course_runs"."producttargetcourserelation_id" IN (SELECT U0."id" FROM "joanie_product_target_course_relation" U0 INNER JOIN "joanie_product_target_course_relation_course_runs" U2 ON (U0."id" = U2."producttargetcourserelation_id") WHERE (U0."product_id" = #::uuid AND U2."courserun_id" IS NOT NULL)) OR "joanie_course_run"."course_id" IN (SELECT W0."id" FROM "joanie_course" W0 INNER JOIN "joanie_product_target_course_relation" W1 ON (W0."id" = W1."course_id") WHERE (W1."product_id" = #::uuid AND NOT (EXISTS(SELECT # AS "a" FROM "joanie_product_target_course_relation" V1 WHERE (V1."id" IN (SELECT U0."id" FROM "joanie_product_target_course_relation" U0 INNER JOIN "joanie_product_target_course_relation_course_runs" U2 ON (U0."id" = U2."producttargetcourserelation_id") WHERE (U0."product_id" = #::uuid AND U2."courserun_id" IS NOT NULL)) AND V1."id" = (W1."id") AND W1."course_id" = (W0."id")) LIMIT #))))) ORDER BY "joanie_course_run"."id" ASC'
OrderModelsTestCase.test_models_order_target_course_runs_property.2:
- db: 'SELECT DISTINCT ... FROM "joanie_course_run" LEFT OUTER JOIN "joanie_order_target_course_relation_course_runs" ON ("joanie_course_run"."id" = "joanie_order_target_course_relation_course_runs"."courserun_id") WHERE ("joanie_order_target_course_relation_course_runs"."ordertargetcourserelation_id" IN (SELECT U0."id" FROM "joanie_order_target_course_relation" U0 INNER JOIN "joanie_order_target_course_relation_course_runs" U2 ON (U0."id" = U2."ordertargetcourserelation_id") WHERE (U0."order_id" = #::uuid AND U2."courserun_id" IS NOT NULL)) OR "joanie_course_run"."course_id" IN (SELECT W0."id" FROM "joanie_course" W0 INNER JOIN "joanie_order_target_course_relation" W1 ON (W0."id" = W1."course_id") WHERE (W1."order_id" = #::uuid AND NOT (EXISTS(SELECT # AS "a" FROM "joanie_order_target_course_relation" V1 WHERE (V1."id" IN (SELECT U0."id" FROM "joanie_order_target_course_relation" U0 INNER JOIN "joanie_order_target_course_relation_course_runs" U2 ON (U0."id" = U2."ordertargetcourserelation_id") WHERE (U0."order_id" = #::uuid AND U2."courserun_id" IS NOT NULL)) AND V1."id" = (W1."id") AND W1."course_id" = (W0."id")) LIMIT #))))) ORDER BY "joanie_course_run"."id" ASC'
OrderModelsTestCase.test_models_order_target_course_runs_property_linked_to_enrollment:
- db: 'SELECT ... FROM "joanie_course_run" INNER JOIN "joanie_enrollment" ON ("joanie_course_run"."id" = "joanie_enrollment"."course_run_id") WHERE "joanie_enrollment"."id" = #::uuid ORDER BY "joanie_course_run"."created_on" DESC'
